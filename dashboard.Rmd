---
title: "Instacart Shopping Trends Dashboard"
output:
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(tidyverse)
library(plotly)
library(p8105.datasets)
library(flexdashboard)
```

```{r}
data("instacart")
instacart_small <- instacart |> sample_n(10000)
glimpse(instacart_small)
```

## Top 10 Most Purchased Product Aisles
```{r}
instacart_small |>
  count(aisle,sort = TRUE) |>
  top_n(10,n) |>
  mutate(aisle=fct_reorder(aisle,n)) |>
  plot_ly(
    x=~n,
    y=~aisle,
    type="bar",
    orientation="h",
    color = ~aisle,
    colors = "viridis",
    showlegend=FALSE
  ) |>
  layout(
    title="Top 10 Most Purchased Product Aisles",
    xaxis=list(title="Number of Orders"),
    yaxis=list(title="")
  )

  
    
```



## Distribution of Add-to-Cart Order
```{r}
instacart_small |>
  plot_ly(
    x = ~add_to_cart_order,
    type = "histogram",
    nbinsx = 30,
    marker = list(color = "viridis")
  ) |>
  layout(
    title = "Distribution of Add-to-Cart Order",
    xaxis = list(title = "Add-to-Cart Order"),
    yaxis = list(title = "Count")
  )
```

## Cart Position vs Order Hour
```{r}
instacart_small |>
  plot_ly(
    x = ~order_hour_of_day,
    y = ~add_to_cart_order,
    type = "scatter",
    mode = "markers",
    color = ~factor(reordered),   
    colors = "viridis"           
  ) |>
  layout(
    title = "Cart Position vs Order Hour (Colored by Reordered)",
    xaxis = list(title = "Hour of Day"),
    yaxis = list(title = "Add-to-Cart Order")
  )
```

Top 8 Departments by Order Share
```{r}
instacart_small |>
  count(department, sort = TRUE) |>
  top_n(8, n) |>
  plot_ly(
    labels = ~department,
    values = ~n,
    type = "pie",
    hole = 0.45, 
    textinfo = "label+percent",
    marker = list(colors = "viridis")
  ) |>
  layout(title = "Top 8 Departments by Order Share")
```

